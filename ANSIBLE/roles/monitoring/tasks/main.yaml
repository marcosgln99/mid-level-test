# VM 1 host configuration and installation
---

- name: Install "Grafana" necessary packages
  apt:
    name: "{{ item }}"
    state: present
    update_cache: yes
  with_items:
    - apt-transport-https
    - software-properties-common
    - wget

- name: Add Grafana GPG key
    apt_key:
      url: https://packages.grafana.com/gpg.key
      state: present

- name: Add Grafana repository
    apt_repository:
      repo: "deb https://packages.grafana.com/oss/deb stable main"
      state: present

- name: Install Grafana
    apt:
      name: grafana
      state: present
      update_cache: yes

- name: Install "Prometheus"
  apt:
    name: prometheus
    state: present

- name: Start Grafana and Prometheus services
  systemd:
    name: "{{ item }}"
    state: started
    enabled: True
  with_items: 
    - grafana-server
    - prometheus